define("rosy/utils/Utils",[],function(){function e(s){var o,u,a,f,l,c,h,p,d;typeof s!="object"&&!n(s)&&(s={}),p=t(arguments[1])?1:2,o=arguments[1]===!0;for(d=arguments.length;p<d;p++)if((u=arguments[p])!=null)for(a in u){f=s[a],l=u[a];if(s===l)continue;o&&l&&(i(l)||(c=r(l)))?(c?(c=!1,h=f&&r(f)?f:[]):h=f&&i(f)?f:{},s[a]=e(h,o,l)):l!==undefined&&(s[a]=l)}return s}function t(e){var t={"function":!0,object:!0,unknown:!0};return e?!!t[typeof e]:!1}function n(e){return typeof e=="function"}function i(e){var n=Object.prototype.hasOwnProperty;if(!e||!t(e)||e.nodeType||e===window)return!1;try{if(e.constructor&&!n.call(e,"constructor")&&!n.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}var i;for(i in e);return i===undefined||n.call(e,i)}var r=Array.isArray||function(e){return e&&e.toString?e.toString()=="[object Array]":!1};return{extend:e,isArray:r,isFunction:n,isObject:t,isPlainObject:i}}),define("rosy/polyfills/function-bind",[],function(){return Function.prototype.bind||(Function.prototype.bind=function(e){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r?this:e||window,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i}),Function.prototype.bind}),define("rosy/base/AbstractClass",["../utils/Utils","../polyfills/function-bind"],function(e){var t=function(e,t){return function(){var n,r=this.sup||null;return this.sup=t,n=e.apply(this,arguments),this.sup=r,n}},n=/xyz/.test(function(){var e;e=!0})?/\bthis\.sup\b/:/.*/;return function(){require.onResourceLoad=function(e,t,n){var r=e.require(t.id);r&&r._isRosyClass&&(r._moduleID=r.prototype._moduleID=t.id)};var r=function(){},i=function(){};return i.extend=function(s){function a(t){var n,r;this.vars&&typeof t=="object"&&(this.vars=e.extend({},this.vars,t));if(this.opts){this.opts=e.extend({},this.opts);if(this.opts.autoProxy===!0)for(r in this)typeof this[r]=="function"&&(this[r]=this[r].bind(this))}return n=this.__init||this.init||this.prototype.constructor,n.apply(this,arguments)}r.prototype=this.prototype;var o,u=e.extend(new r,s);for(o in s)o!=="static"&&typeof s[o]=="function"&&typeof this.prototype[o]=="function"&&n.test(s[o])?u[o]=t(s[o],this.prototype[o]):typeof s[o]=="object"&&(s[o]instanceof Array?u[o]=s[o].concat():s[o]!==null&&(o==="vars"||o==="opts"?u[o]=e.extend({},!0,this.prototype[o],s[o]):o==="static"?u[o]=e.extend({},this.prototype[o],s[o]):u[o]=e.extend({},s[o])));return u.extend=i.extend.bind(a),a.prototype=u,e.extend(a,this,u["static"]),a._isRosyClass=!0,a.prototype.constructor=a,typeof a.prototype.setup=="function"&&a.prototype.setup.call(a),a},i}()}),define("rosy/polyfills/array-indexof",[],function(){return Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){if(!this.length||!(this instanceof Array)||arguments.length<1)return-1;t=t||0;if(t>=this.length)return-1;while(t<this.length){if(this[t]===e)return t;t+=1}return-1}),Array.prototype.indexOf}),define("rosy/base/NotificationManager",["../utils/Utils","../polyfills/array-indexof"],function(e){function i(e){n.push(e),s(e)}function s(e){var t=e.name;if(r[t]){var n=r[t].slice(0),i=n.length;while(e.pointer<i){if(e.status!==1)return;n[e.pointer].apply(null,[].concat(e,e.args)),e.pointer++}n=null,e.status===1&&!e.callback&&e.cancel()}}var t=function(e,t,n){return this.name=e,this.args=t,this.data=t&&t.length===1?t[0]:null,this.callback=n,this};t.prototype.data={},t.prototype.name="",t.prototype.dispatcher=null,t.prototype.status=0,t.prototype.pointer=0,t.prototype.callback=null,t.prototype.hold=function(){this.status=2},t.prototype.release=function(){this.status=1,o.releaseNotification(this)},t.prototype.cancel=function(){this.data={},this.name="",this.status=0,this.pointer=0,this.dispatcher=null,this.callback=null,o.cancelNotification(this)},t.prototype.dispatch=function(e){this.status=1,this.pointer=0,this.dispatcher=e,o.publishNotification(this)},t.prototype.respond=function(){this.callback&&(this.callback.apply(this.dispatcher,arguments),this.cancel())};var n=[],r={},o={};return o.subscribe=function(e,t,n){n=isNaN(n)?-1:n,r[e]=r[e]||[],n<=-1||n>=r[e].length?r[e].push(t):r[e].splice(n,0,t)},o.unsubscribe=function(e,t){var n=r[e].indexOf(t);n>-1&&r[e].splice(n,1)},o.publish=function(){var n,r=Array.prototype.slice.call(arguments),s=r[0],o=r[r.length-1],u=r[r.length-2];u=e.isFunction(u)?u:null,r=r.slice(1,u?r.length-2:r.length-1),n=new t(s,r,u),n.status=1,n.pointer=0,n.dispatcher=o,i(n)},o.releaseNotification=function(e){e.status=1,n.indexOf(e)>-1&&s(e)},o.cancelNotification=function(e){n.splice(n.indexOf(e),1),e=null},o}),define("rosy/base/Class",["./AbstractClass","./NotificationManager","../polyfills/function-bind","../polyfills/array-indexof"],function(e,t){return e.extend({opts:{autoProxy:!0},init:function(){},subscribe:function(e,n,r){this._interestHandlers=this._interestHandlers||{},n&&!this._interestHandlers[e]&&(n=n,t.subscribe(e,n,r),this._interestHandlers[e]=n)},unsubscribe:function(e){if(!e)return this.unsubscribeAll();if(this._interestHandlers&&this._interestHandlers[e]){var n=this._interestHandlers[e];this._interestHandlers[e]=null,delete this._interestHandlers[e],t.unsubscribe(e,n)}},unsubscribeAll:function(){for(var e in this._interestHandlers)this._interestHandlers.hasOwnProperty(e)&&this.unsubscribe(e);this._interestHandlers=[]},publish:function(){var e=Array.prototype.slice.call(arguments);t.publish.apply(t,[].concat(e,this))},proxy:function(e){return e?e.bind(this):e},setTimeout:function(e,t){return window.setTimeout(this.proxy(e),t)},setInterval:function(e,t){return window.setInterval(this.proxy(e),t)},on:function(e,t){var n=this["on_"+e]=this["on_"+e]||[];return n.push(t),!0},off:function(e,t){var n=this["on_"+e],r;if(n){if(!t)return this["on_"+e]=[],!0;r=n.indexOf(t);while(r>-1)n.splice(r,1),r=n.indexOf(t);return!0}},trigger:function(e,t){var n,r,i,s;e=e.split(":");while(e.length){r=e.join(":"),n=this["on_"+r];if(n&&n.length){t=[].concat(r,this,t||[]);for(i=0,s=n.length;i<s;i++)n[i].apply(null,t)}e.pop()}},destroy:function(){var e;for(e in this)e.indexOf("on_")>=0&&this.off(e.replace("on_"));this.unsubscribe()}})}),define("rosy/base/DOMClass",["../base/Class","$"],function(e,t){function n(e,t,n){var r,i,s,o,u,a;for(r in n)for(i=0,s=n[r].length;i<s;i++){if(!n[r])break;o=n[r][i];if(!o)break;for(u in e)a=e[u],a.guid&&typeof a=="function"&&a.guid===o.handler.guid&&t.off(r,a)}}function r(e,i){if(!i)return;var s,o,u;for(s in i){o=i[s];if(o instanceof t){var a,f,l;for(a=0,f=o.length;a<f;a++)l=o[a],u=t._data(l,"events"),u&&n(e,o.eq(a),u)}else t.isPlainObject(o)&&r(e,o)}}return e.extend({preventDefault:function(e){e.preventDefault()},proxy:function(e){return t.proxy(e,this)},destroy:function(){this.unbindEvents(),this.sup()},unbindEvents:function(){for(var e in this)t.isPlainObject(this[e])&&r(this,this[e])}})}),define("rosy/views/ViewNotification",[],function(){return{VIEW_INITIALIZED:"VIEW_INITIALIZED",VIEW_LOAD_STARTED:"VIEW_LOAD_STARTED",VIEW_LOAD_COMPLETED:"VIEW_LOAD_COMPLETED",VIEW_IN_STARTED:"VIEW_IN_STARTED",VIEW_IN_COMPLETED:"VIEW_IN_COMPLETED",VIEW_OUT_STARTED:"VIEW_OUT_STARTED",VIEW_OUT_COMPLETED:"VIEW_OUT_COMPLETED",VIEW_CLEANUP_STARTED:"VIEW_CLEANUP_STARTED",VIEW_CLEANUP_COMPLETED:"VIEW_CLEANUP_COMPLETED",VIEW_CLOSED:"VIEW_CLOSED",VIEW_CHANGED:"VIEW_CHANGED",VIEW_UPDATED:"VIEW_UPDATED",VIEW_CHANGE_CANCELLED:"VIEW_CHANGE_CANCELLED",VIEW_UPDATE_CANCELLED:"VIEW_UPDATE_CANCELLED",TITLE_CHANGED:"TITLE_CHANGED"}}),define("rosy/views/View",["../base/DOMClass","./ViewNotification"],function(e,t){var n=1e4,r=function(e){throw e};return e.extend({config:null,data:null,params:null,viewGroup:null,viewClass:null,routeRegEx:null,_loadCB:null,_inCB:null,_outCB:null,_cleanupCB:null,_loadTimeout:null,_inTimeout:null,_outTimeout:null,_cleanupTimeout:null,"static":{setMaxWaitTime:function(e){n=e},setErrorHandler:function(e){r=e}},init:function(){},update:function(e,t){return!0},canClose:function(e){return!0},load:function(){r(new Error(this.viewClass+" must implement the load() method."))},transitionIn:function(){r(new Error(this.viewClass+" must implement the transitionIn() method."))},transitionOut:function(){r(new Error(this.viewClass+" must implement the transitionOut() method."))},destroy:function(){r(new Error(this.viewClass+" must implement the destroy() method."))},cleanup:function(){this.destroy(),this.cleanupComplete()},changeRoute:function(){this.viewGroup.viewManager.changeRoute.apply(null,arguments)},updateTitle:function(e){this.viewGroup.viewManager.updateTitle(e)},closeViewGroup:function(){this.viewGroup.close.apply(null,arguments)},loadComplete:function(){return this._loadTimeout&&(clearTimeout(this._loadTimeout),this._loadTimeout=null),this.publish(t.VIEW_LOAD_COMPLETED,{view:this,viewGroup:this.viewGroup}),this._loadCB?this._loadCB():null},transitionInComplete:function(){return this._inTimeout&&(clearTimeout(this._inTimeout),this._inTimeout=null),this.publish(t.VIEW_IN_COMPLETED,{view:this,viewGroup:this.viewGroup}),this._inCB?this._inCB():null},transitionOutComplete:function(){return this._outTimeout&&(clearTimeout(this._outTimeout),this._outTimeout=null),this.publish(t.VIEW_OUT_COMPLETED,{view:this,viewGroup:this.viewGroup}),this._outCB?this._outCB():null},cleanupComplete:function(){return this._cleanupTimeout&&(clearTimeout(this._cleanupTimeout),this._cleanupTimeout=null),this.__destroy(),this.publish(t.VIEW_CLEANUP_COMPLETED,{view:this,viewGroup:this.viewGroup}),this._cleanupCB?this._cleanupCB():null},__init:function(e,n,r,i){this.data={},this.params={},this.viewGroup=e,this.config=n,this.__update(r,i,!0),this.init(),this.publish(t.VIEW_INITIALIZED,{view:this,viewGroup:this.viewGroup})},__canClose:function(e){var n=this.canClose(e);return n||this.publish(t.VIEW_CHANGE_CANCELLED,{view:this,viewGroup:this.viewGroup}),n},__update:function(e,n,r){var i;if(!r&&this.update(e,n)===!1)return this.publish(t.VIEW_UPDATE_CANCELLED,{view:this,viewGroup:this.viewGroup}),!1;for(i in e)this.params[i]=e[i];for(i in n)this.data[i]=n[i];this.publish(t.VIEW_UPDATED,{view:this,viewGroup:this.viewGroup})},__load:function(e){this._loadTimeout=this.setTimeout(function(){r(new Error(this.viewClass+" : loadComplete() was never called."))},n),this._loadCB=e,this.publish(t.VIEW_LOAD_STARTED,{view:this,viewGroup:this.viewGroup}),this.load.call(this)},__transitionIn:function(e){this._inTimeout=this.setTimeout(function(){r(new Error(this.viewClass+" : transitionInComplete() was never called."))},n),this._inCB=e,this.publish(t.VIEW_IN_STARTED,{view:this,viewGroup:this.viewGroup}),this.transitionIn.call(this),this.viewGroup.activate()},__transitionOut:function(e){this._outTimeout=this.setTimeout(function(){r(new Error(this.viewClass+" : transitionOutComplete() was never called."))},n),this._outCB=e,this.publish(t.VIEW_OUT_STARTED,{view:this,viewGroup:this.viewGroup}),this.transitionOut.call(this)},__cleanup:function(e){this._cleanupTimeout=this.setTimeout(function(){r(new Error(this.viewClass+" : cleanupComplete() was never called."))},n),this._cleanupCB=e,this.publish(t.VIEW_CLEANUP_STARTED,{view:this,viewGroup:this.viewGroup}),this.cleanup.call(this)},__destroy:function(){this.config=null,this.data=null,this.params=null,this.viewClass=null,this._loadCB=null,this._inCB=null,this._outCB=null,this.unbindEvents(),this.unsubscribe()}})}),define("rosy/views/ViewGroup",["../base/Class"],function(e){return e.extend({viewManager:null,id:null,config:{},routes:[],history:null,currentRoute:null,currentView:null,transitioning:!1,deferredTransition:null,init:function(e,t){this.history=[],this.id=e.config.id||null,this.currentView=null,this.config=e.config,this.routes=e.routes,this.viewManager=t},activate:function(){this.viewManager.activate(this.currentRoute)},deactivate:function(){this.viewManager.deactivate(this.currentRoute)},close:function(){var e=arguments.length>1?arguments[0]:this,t=arguments.length>1?arguments[1]:arguments[0];this.deactivate(),this.__updateRoute(null),this.viewManager.closeViewGroup(e,t)},__updateRoute:function(e){this.currentRoute=e,this.history.push(this.currentRoute)}})}),define("rosy/views/ViewRouter",["../base/Class","../utils/Utils"],function(e,t){return e.extend({_routes:[],init:function(e){var t,n,r,i,s,o,u,a;for(i=e.length,t=i-1;t>=0;t--)for(s=e[t].routes.length,n=s-1;n>=0;n--){u=e[t].routes[n],u.routes=u.routes||[],u.route&&u.routes.push(u.route);for(o=u.routes.length,r=o-1;r>=0;r--)a=this._normalize(u.routes[r]),this._routes.push({path:a[0],params:a[1],viewConfig:u.config||{},viewClass:u.viewClass,viewGroup:e[t]})}},getViewsByRoute:function(e){var t,n,r,i,s,o,u,a,f=[];for(r=this._routes.length,t=0;t<r;t++){s=this._routes[t],o=s.path.exec(e);if(o){a={};for(n=1,i=o.length;n<i;n++)u=s.params[n-1],a[u.name]=o[n]||null;f.push({params:a,viewClass:s.viewClass,viewGroup:s.viewGroup,viewConfig:s.viewConfig,regex:s.path})}}return f.length?f:!1},getRouteRegexes:function(e){var t,n,r,i,s,o=[],u={};for(t=0,n=this._routes.length;t<n;t++)r=this._routes[t].path,i=r.exec(e),s=r.toString(),i&&!u[s]&&(o.push(r),u[s]=!0);return o.length?o:!1},_normalize:function(e){var t=[],n=!1,r=!1;return e instanceof RegExp?[e,[]]:e.indexOf("regex:")>-1?[new RegExp(e.replace("regex:","")),[]]:(e instanceof Array&&(e="("+e.join("|")+")"),e=e.concat(n?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(e,n,r,i,s,o){return t.push({name:i,optional:!!o}),n=n||"",""+(o?"":n)+"(?:"+(o?n:"")+(r||"")+(s||r&&"([^/.]+?)"||"([^/]+?)")+")"+(o||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),[new RegExp("^"+e+"$",r?"":"i"),t])}})}),define("rosy/views/TransitionManager",["../base/Class"],function(e){var t={sync:[["transitionOut"],["cleanup"],["load"],["transitionIn"],["complete"]],async:[["load"],["transitionIn","transitionOut"],["cleanup"],["complete"]],preload:[["load"],["transitionOut"],["transitionIn"],["cleanup"],["complete"]],reverse:[["load"],["transitionIn"],["transitionOut"],["cleanup"],["complete"]]},n=e.extend({transition:function(e,t,n,r){var i,s,o;return e.viewGroup.transitioning===!0?(e.viewGroup.deferredTransition={view:e,data:t,transition:n,cb:r},!1):(n||(n=e.viewConfig.transition||e.viewGroup.config.transition||"sync"),e.viewGroup.transitioning=!0,i=e.viewGroup.currentView,require([e.viewClass],this.proxy(function(u){s=new u(e.viewGroup,e.viewConfig,e.params,t),s.viewClass=e.viewClass,s.routeRegEx=e.regex,e.viewGroup.newView=s,o={load:s.__load.bind(s),transitionIn:s.__transitionIn.bind(s),transitionOut:i&&i.__transitionOut?i.__transitionOut.bind(i):null,cleanup:i&&i.__cleanup?i.__cleanup.bind(i):null,complete:function(){e.viewGroup.newView=null,e.viewGroup.currentView=s,e.viewGroup.transitioning=!1,e.viewGroup.deferredTransition&&e.viewGroup.deferredTransition.view&&this.transitionDeferred(e.viewGroup),r&&r()}.bind(this)},this._nextInSequence(0,n,o)})),!0)},close:function(e,t){var n,r;if(!e)throw new Error("Invalid view group.");e.newView=null,n=e.currentView,n&&(e.transitioning=!0,r={load:null,transitionIn:null,transitionOut:n.__transitionOut.bind(n),cleanup:n.__cleanup.bind(n),complete:function(){e.currentRoute=null,e.currentView=null,e.transitioning=!1,t&&t()}},this._nextInSequence(0,"reverse",r))},transitionDeferred:function(e){var t=e.deferredTransition;e.deferredTransition=null,this.transition(t.view,t.data,t.transition,t.cb)},_nextInSequence:function(e,n,r){if(e>=t[n].length)return;var i,s,o=0,u=t[n],a=this.proxy(function(e){if(!e){f(!0);return}e(f)}),f=this.proxy(function(t){o++,(o>=s||t)&&this._nextInSequence(e+1,n,r)});for(i=0,s=u[e].length;i<s;i++)a(r[u[e][i]])}});return new n}),define("rosy/views/ViewManager",["../base/Class","../utils/Utils","./View","./ViewGroup","./ViewRouter","./TransitionManager","./ViewNotification","$"],function(e,t,n,r,i,s,o,u){var a=window.history&&window.history.pushState,f,l,c=function(e){throw e},h=e.extend({_pollInterval:null,_router:null,_viewGroups:[],_activeElements:{},fallbackMode:"hard",aliases:[],selectors:["[data-route]","a[href^='#']","a[href^='/']"],activeClass:"active",disabledClass:"disabled",bubble:!1,container:null,initialized:!1,initialize:function(e){this.initialized&&c(new Error("ViewManager has already been initialized."));var t,o,h,p=e.viewGroups,d=e.defaultRoute||null;e.fallbackMode=e.fallbackMode==="hash"?"#":e.fallbackMode,s=e.TransitionManager||s,this.fallbackMode=e.fallbackMode||this.fallbackMode,this.aliases=e.aliases||this.aliases,this.selectors=e.selectors||this.selectors,this.activeClass=e.activeClass||this.activeClass,this.bubble=e.bubble||this.bubble,this.container=u(e.container||document),e.maxWaitTime&&n.setMaxWaitTime(e.maxWaitTime),e.errorHandler&&(c=e.errorHandler,n.setErrorHandler(e.errorHandler));for(t=0,o=p.length;t<o;t++)h=new r(p[t],this),h.config=h.config||{},h.config.useHistory=h.config.useHistory==="hash"?"#":h.config.useHistory,this._viewGroups.push(h),h.config.useHistory==="#"&&this.fallbackMode==="#"&&c(new Error("You can't use the 'hash' fallback mode in conjunction with useHistory = 'hash'"));this._router=new i(this._viewGroups),a?(l=window.location.pathname,window.addEventListener("popstate",this._onStateChange)):this.fallbackMode==="#"&&(f=window.location.hash,this._pollInterval=this.setInterval(this._pollForHashChange,100)),this.container.on("click",this.selectors.join(","),this._onLinkClick),window.location.hash&&this._gotoRoute({route:window.location.hash}),this._gotoRoute({route:d||window.location.pathname}),this.initialized=!0},changeRoute:function(e){var n=t.isObject(arguments[1])?arguments[1]:{};n.route=e,n.transition=typeof arguments[1]=="string"?arguments[1]:null,n.cb=t.isFunction(arguments[1])?arguments[1]:arguments[2]||null,this._gotoRoute(n)},updateTitle:function(e){a&&history.replaceState(null,e,window.location.href+window.location.hash),document.title=e,this.publish(o.TITLE_CHANGED,{title:e})},closeViewGroup:function(e,t){t=typeof t=="function"?t:null,e=typeof e=="string"?this.getViewGroup(e):e,s.close(e,t),e.config.useHistory==="#"&&(f=window.location.hash="")},getViewGroup:function(e){var t,n,r;for(t=0,n=this._viewGroups.length;t<n;t++){r=this._viewGroups[t];if(r.id===e)return r}return!1},activate:function(){var e,t,n,r,i,s,o,a,f,l,c,h,p=[],d=this.container.find(this.selectors.join(","));for(e=0,t=arguments.length;e<t;e++)l=arguments[e],h=this._router.getRouteRegexes(l),p.push({route:l,regexes:h});for(e=0,t=d.length;e<t;e++){f=u(d[e]);if(f.data("active-disabled")==null&&!f.hasClass(this.activeClass)){c=f.data("route")||f.attr("href");for(n=0,r=p.length;n<r;n++){l=p[n].route,h=p[n].regexes;for(i=0,s=h.length;i<s;i++)o=h[i].exec(l),a=h[i].exec(c),a&&this._regexMatch(o,a)&&(f.addClass(this.activeClass),this._activeElements[l]=this._activeElements[l]||[],this._activeElements[l].push(f))}}}},deactivate:function(){var e,t,n,r,i;for(e=0,t=arguments.length;e<t;e++){i=arguments[e];if(this._activeElements[i]){for(n=0,r=this._activeElements[i].length;n<r;n++)u(this._activeElements[i][n]).removeClass(this.activeClass);this._activeElements[i]=null}}},_onLinkClick:function(e){var t=u(e.currentTarget),n=t.data();if(!t.attr("target")){if(t.hasClass(this.disabledClass))return e.preventDefault(),!1;n.route=n.route||t.attr("href");if(n.route){n.event=e,n.eventReturn=!0,this._gotoRoute(n);if(!this.bubble)return n.eventReturn}}},_pollForHashChange:function(){window.location.hash!==f&&(f=window.location.hash,this._gotoRoute({route:f},null,!0))},_onStateChange:function(){if(window.location.pathname!==l){l=window.location.pathname,this._gotoRoute({route:window.location.pathname,updateHistory:!1});return}},_gotoRoute:function(e){var n,r,i,s=0,o,u,a,f,l,c=!1;e.route=e.route.replace("#",""),e.route=(e.route.substr(0,1)!=="/"?"/":"")+e.route,e.route=this.aliases[e.route]||e.route,e.cb&&(i=e.cb,e.cb=null,delete e.cb),u=this._router.getViewsByRoute(e.route);if(u){e.event&&(e.event.preventDefault(),e.eventReturn=!1);for(n=0,r=u.length;n<r;n++){o=u[n],a=o.viewGroup,f=o.viewGroup.currentView;if(o.viewGroup.currentRoute!==e.route&&f&&!a.transitioning)if(f.routeRegEx===o.regex){if(f.__update(o.params,e)===!1)return i&&i(),!1}else{l=t.extend({},e,o),l.viewGroup=null,delete l.viewGroup;if(!f.__canClose(l))return i&&i(),!1}}for(n=0;n<r;n++){o=u[n],a=o.viewGroup,f=o.viewGroup.newView||o.viewGroup.currentView;if(a.currentRoute!==e.route){this.deactivate(a.currentRoute);if(!e.viewGroup||a.id===e.viewGroup)a.__updateRoute(e.route),a.config.useHistory&&e.updateHistory!==!1&&this._updateHistory(e.title||"",e.route,a.config.useHistory==="#"),!f||f.routeRegEx!==o.regex?(this._changeView(o,e,i),c=!0):f&&s++}else s++}for(n=0,r=this._viewGroups.length;n<r;n++)this.activate(this._viewGroups[n].currentRoute);return s===r?(i&&i(),!1):c}return!1},_changeView:function(e,t,n){t=t||{},e.viewClass?require([e.viewClass],this.proxy(function(){s.transition(e,t,t.transition,this.proxy(function(){this.publish(o.VIEW_CHANGED,{view:e,viewGroup:e.viewGroup}),n&&n()}))})):s.close(e.viewGroup,this.proxy(function(){this.publish(o.VIEW_CLOSED,{view:e,viewGroup:e.viewGroup}),n&&n()}))},_updateHistory:function(e,t,n){if(a&&!n)history.pushState(null,e||"",t+window.location.search+window.location.hash);else if(n||this.fallbackMode==="#")this._pollInterval||(f=f||window.location.hash,this._pollInterval=this.setInterval(this._pollForHashChange,100)),window.location.hash=t},_regexMatch:function(e,t){var n,r;e=e.concat(),t=t.concat(),e.splice(0,1),t.splice(0,1);for(r=e.length,n=r;n>=0;n--)if(e[n]!==t[n]&&typeof t[n]!="undefined")return!1;return!0}});return new h}),define("test/config/routes",["module"],function(e){var t=e.id.split("/");return t.splice(t.length-2,2,""),t=t.join("/"),{aliases:{"/":"/index.html"},viewGroups:[{config:{id:"main",selector:"#main",useHistory:!0,transition:"async"},routes:[{viewClass:t+"views/Home",route:"/index.html",config:{bodyClass:"home",title:"Home"}},{viewClass:t+"views/About",route:"/about.html",config:{bodyClass:"about",title:"About"}},{viewClass:t+"views/Contact",route:"/contact.html",config:{bodyClass:"contact",title:"Contact"}}]}]}}),define("test/Site",["rosy/base/Class","rosy/views/ViewManager","./config/routes"],function(e,t,n){var r=e.extend({initialized:!1,initialize:function(){this.initialized||(t.initialize({aliases:n.aliases,viewGroups:n.viewGroups}),this.initialized=!0)}});return new r}),require.config({paths:{$:"//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min",CFInstall:"//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min",ChromeFrame:"rosy/modules/google-chrome-frame/ChromeFrame",Cookies:"libs/cookies",Handlebars:"libs/handlebars",zynga:"libs/zynga",templates:"../../templates",json:"libs/json3",$plugin:"libs/plugins/amd/jquery-plugin",jsonFile:"libs/plugins/amd/jsonFile",text:"libs/plugins/amd/text"},waitSeconds:15,shim:{$:{exports:"jQuery"},"zynga/Scroller":{exports:"Scroller",deps:["zynga/Animate"]},CFInstall:{exports:"CFInstall"},Handlebars:{exports:"Handlebars"}}})